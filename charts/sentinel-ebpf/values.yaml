global:
  imagePullSecrets: []

probe:
  clusterName: ""
  image:
    repository: ghcr.io/shepherd-itsec/sentinel-ebpf-probe
    tag: "latest"
    pullPolicy: IfNotPresent
  grpc:
    # Default: use detector service name from release (fullname-detector:port). Override if needed.
    endpoint: ""
    tls:
      enabled: false
      caSecret: ""
  stream:
    mode: grpc # grpc | stdout | file
    batchSize: 64
    queueLength: 10000  # Increased from 1024 to handle high event rates
    ringBufferPages: 64
    file:
      path: /var/log/sentinel-ebpf/events.bin
      rotateMaxBytes: 52428800
      rotateMaxFiles: 3
      compress: false
  probes:
    fileWrites:
      enabled: true
      pathPrefixes: []
  storage:
    pvc:
      enabled: false
      size: 1Gi
      storageClassName: ""
      accessModes: ["ReadWriteOnce"]
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  securityContext:
    privileged: true
    runAsUser: 0
    runAsGroup: 0
    capabilities:
      add: ["SYS_ADMIN", "SYS_RESOURCE", "SYS_PTRACE"]
  serviceAccount:
    create: true
    name: ""
    annotations: {}
  rbac:
    create: true

detector:
  enabled: true
  image:
    repository: ghcr.io/shepherd-itsec/sentinel-ebpf-detector
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 50051
  eventsPort: 50052  # HTTP API for recent events (UI log tail in gRPC mode)
  # Model configuration (River anomaly detection)
  model:
    algorithm: "memstream"  # halfspacetrees | loda | memstream
    threshold: 0.5  # Anomaly score threshold (0-1)
    # Half-Space Trees parameters
    hst_n_trees: 25
    hst_height: 15
    hst_window_size: 250
    # LODA parameters
    loda_n_projections: 20
    loda_bins: 64
    loda_range: 3.0
    loda_ema_alpha: 0.01
    loda_hist_decay: 1.0
    # MemStream parameters
    mem_hidden_dim: 32
    mem_latent_dim: 8
    mem_memory_size: 128
    mem_lr: 0.001
    seed: 42
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

ui:
  enabled: false
  image:
    repository: ghcr.io/shepherd-itsec/sentinel-ebpf-ui
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8080
  logPath: /var/log/sentinel-ebpf/events.bin
  pollSeconds: 3
  logLimit: 50
  # Defaults use chart fullname. Override if needed.
  detectorGrpcAddr: ""
  detectorEventsUrl: ""  # recent-events API for log tail in gRPC mode (default: http://...-detector:50052/recent_events)
  probeHealthUrl: ""
  probeMetricsUrl: ""
  detectorMetricsUrl: ""
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

config:
  logLevel: info
  metrics:
    enabled: true
    port: 9102
  health:
    port: 9101
  rules:
    # Default capture-all opens
    rules:
      - name: capture-all-opens
        enabled: true
        event: file_open
        match:
          pathPrefixes: ["/"]
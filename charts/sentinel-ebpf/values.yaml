global:
  imagePullSecrets: []

probe:
  clusterName: ""
  image:
    repository: ghcr.io/shepherd-itsec/sentinel-ebpf-probe
    tag: "latest"
    pullPolicy: IfNotPresent
  grpc:
    endpoint: "sentinel-ebpf-detector:50051"
    tls:
      enabled: false
      caSecret: ""
  stream:
    mode: grpc # grpc | stdout | file
    batchSize: 64
    queueLength: 1024
    ringBufferPages: 64
    file:
      path: /var/log/sentinel-ebpf/events.bin
      rotateMaxBytes: 52428800
      rotateMaxFiles: 3
      compress: false
  probes:
    fileWrites:
      enabled: true
      pathPrefixes: []
  storage:
    pvc:
      enabled: false
      size: 1Gi
      storageClassName: ""
      accessModes: ["ReadWriteOnce"]
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  securityContext:
    privileged: true
    runAsUser: 0
    runAsGroup: 0
    capabilities:
      add: ["SYS_ADMIN", "SYS_RESOURCE", "SYS_PTRACE"]
  serviceAccount:
    create: true
    name: ""
    annotations: {}
  rbac:
    create: true

detector:
  enabled: true
  image:
    repository: ghcr.io/shepherd-itsec/sentinel-ebpf-detector
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 50051
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

ui:
  enabled: false
  image:
    repository: ghcr.io/shepherd-itsec/sentinel-ebpf-ui
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8080
  logPath: /var/log/sentinel-ebpf/events.bin
  pollSeconds: 10
  logLimit: 50
  detectorGrpcAddr: "sentinel-ebpf-detector:50051"
  probeHealthUrl: "http://sentinel-ebpf-probe:9101/healthz"
  probeMetricsUrl: "http://sentinel-ebpf-probe:9102/metrics"
  detectorMetricsUrl: ""
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

config:
  logLevel: info
  metrics:
    enabled: true
    port: 9102
  health:
    port: 9101
  rules:
    # Default capture-all opens
    rules:
      - name: capture-all-opens
        enabled: true
        event: file_open
        match:
          pathPrefixes: ["/"]